[DEFAULT]

# Path
root_helper=sudo
rootwrap_config=/etc/cinder/rootwrap.conf
api_paste_config=/etc/cinder/api-paste.ini
policy_file=/etc/cinder/policy.json
policy_default_rule=default

pybasedir={{pybasedir}}
bindir=\$pybasedir/bin
state_path={{state_path}}
volumes_dir=\$state_path/volumes
lock_path={{lock_path}}
log_dir={{log_dir}}

# Quota
quota_volumes={{quota_volumes}}
quota_snapshots={{quota_snapshots}}
quota_gigabytes={{quota_gigabytes}}
reservation_expire={{reservation_expire}}
until_refresh=0
max_age=0
quota_driver=cinder.quota.DbQuotaDriver
use_default_quota_class=true

# Service
report_interval={{report_interval}}
periodic_interval={{periodic_interval}}
periodic_fuzzy_delay={{periodic_fuzzy_delay}}
osapi_volume_listen=0.0.0.0
osapi_volume_listen_port={{osapi_volume_listen_port}}

# WSGI
backlog=4096
tcp_keepidle=600

# API
osapi_max_limit=1000

use_forwarded_for=false
osapi_max_request_body_size=114688


# Backup to [Ceph,Swift]
{% if backup_driver == "cinder.backup.driver.ceph" %}
# Backup to Ceph
backup_driver={{backup_driver}}
backup_ceph_conf={{backup_ceph_conf}}
backup_ceph_user={{backup_ceph_user}}
backup_ceph_chunk_size={{backup_ceph_chunk_size}}
backup_ceph_pool={{backup_ceph_pool}}
backup_ceph_stripe_unit={{backup_ceph_stripe_unit}}
backup_ceph_stripe_count={{backup_ceph_stripe_count}}
restore_discard_excess_bytes={{restore_discard_excess_bytes}}
{% elif backup_driver == "cinder.backup.driver.swift" %}
# Backup to Swift
backup_driver={{backup_driver}}
backup_swift_url={{backup_swift_url}}
backup_swift_auth={{backup_swift_auth}}
backup_swift_user={{backup_swift_user}}
backup_swift_key={{backup_swift_key}}
backup_swift_container={{backup_swift_container}}
backup_swift_object_size={{backup_swift_object_size}}
backup_swift_retry_attempts={{backup_swift_retry_attempts}}
backup_swift_retry_backoff={{backup_swift_retry_backoff}}
backup_compression_algorithm={{backup_compression_algorithm}}
{% endif %}

# Common
#connection_type=

my_ip={{my_ip}}
glance_host={{glance_host}}
glance_port={{glance_port}}
#glance_api_servers=\$glance_host:\$glance_port
glance_api_version=1
glance_num_retries=0
glance_api_insecure={{glance_api_insecure}}
glance_api_ssl_compression={{glance_api_ssl_compression}}
#allowed_direct_url_schemes=
scheduler_topic=cinder-scheduler
volume_topic=cinder-volume
backup_topic=cinder-backup
enable_v1_api={{enable_v1_api}}
enable_v2_api={{enable_v2_api}}
api_rate_limit={{api_rate_limit}}
#osapi_volume_ext_list=
osapi_volume_extension=cinder.api.contrib.standard_extensions
volume_manager=cinder.volume.manager.VolumeManager
backup_manager=cinder.backup.manager.BackupManager
scheduler_manager=cinder.scheduler.manager.SchedulerManager
host={{ansible_hostname}}
storage_availability_zone={{storage_availability_zone}}
default_availability_zone={{default_availability_zone}}

{% if memcached_servers  %}
memcached_servers={{memcached_servers}}
{% endif %}

{% if default_volume_type %}
default_volume_type{{default_volume_type}}
{% endif %}

volume_usage_audit_period=month
monkey_patch=false
#monkey_patch_modules=
service_down_time=60
volume_api_class=cinder.volume.api.API
backup_api_class=cinder.backup.api.API
auth_strategy=keystone
#enabled_backends={{enabled_backends}}
no_snapshot_gb_quota={{no_snapshot_gb_quota}}
transfer_api_class=cinder.transfer.api.API

# Compute
compute_api_class=cinder.compute.nova.API
nova_catalog_info=compute:nova:internalURL
nova_catalog_admin_info=compute:nova:adminURL
#os_region_name=<None>
nova_api_insecure={{nova_api_insecure}}

# Database
db_backend=sqlalchemy
enable_new_services=true
volume_name_template=volume-%s
snapshot_name_template=snapshot-%s
backup_name_template=backup-%s
db_driver=cinder.db

use_tpool=false
sql_connection=mysql://{{cinder_db_user}}:{{cinder_db_password}}@{{cinder_db_host}}/{{cinder_db}}?charset=utf8
idle_timeout=3600
min_pool_size=1
max_pool_size=5
max_retries=10
retry_interval=10
connection_debug=0
connection_trace=false

# Keymanager
api_class=cinder.keymgr.conf_key_mgr.ConfKeyManager

# Common Lockutils
disable_process_locking=false

# Common log
debug={{debug}}
verbose={{verbose}}

use_stderr=true
#logging_context_format_string=%(asctime)s.%(msecs)03d %(process)d %(levelname)s %(name)s [%(request_id)s %(user)s %(tenant)s] %(instance)s%(message)s
#logging_default_format_string=%(asctime)s.%(msecs)03d %(process)d %(levelname)s %(name)s [-] %(instance)s%(message)s
#logging_debug_format_suffix=%(funcName)s %(pathname)s:%(lineno)d
#logging_exception_prefix=%(asctime)s.%(msecs)03d %(process)d TRACE %(name)s %(instance)s
#default_log_levels=amqplib=WARN,sqlalchemy=WARN,boto=WARN,suds=INFO,keystone=INFO,eventlet.wsgi.server=WARN
publish_errors=false
fatal_deprecations=false
instance_format=[instance: %(uuid)s]
instance_uuid_format=[instance: %(uuid)s]
#log_config=<None>
#log_format=<None>
log_date_format=%Y-%m-%d %H:%M:%S
#log_file=<None>
use_syslog={{use_syslog}}
syslog_log_facility={{syslog_log_facility}}

# Common notifier
#notification_driver=
default_notification_level=INFO
#default_publisher_id=<None>
notification_topics=notifications
topics=notifications

# Common Periodic
run_external_periodic_tasks=true

# Common RPC
rpc_backend=cinder.openstack.common.rpc.impl_kombu
rpc_thread_pool_size=64
rpc_conn_pool_size=30
rpc_response_timeout=60
rpc_cast_timeout=30
allowed_rpc_exception_modules=nova.exception,cinder.exception,exceptions
fake_rabbit=false
control_exchange=openstack
amqp_rpc_single_reply_queue=false
amqp_durable_queues=false
amqp_auto_delete=false

{% if rabbit_hosts %}
rabbit_hosts={{rabbit_hosts}}
{% else %}
rabbit_host={{rabbit_host}}
rabbit_port={{rabbit_port}}
{% endif %}
rabbit_use_ssl={{rabbit_use_ssl}}
rabbit_userid={{rabbit_cinder_user}}
rabbit_password={{rabbit_cinder_password}}
rabbit_virtual_host={{rabbit_cinder_vhost}}
rabbit_retry_interval=1
rabbit_retry_backoff=2
rabbit_max_retries=0
rabbit_ha_queues={{rabbit_ha_queues}}

# Scheduler
scheduler_host_manager=cinder.scheduler.host_manager.HostManager
scheduler_max_attempts=3
scheduler_default_filters=AvailabilityZoneFilter,CapacityFilter,CapabilitiesFilter
scheduler_default_weighers=CapacityWeigher
scheduler_driver=cinder.scheduler.filter_scheduler.FilterScheduler
#scheduler_json_config_location=
max_gigabytes=10000
capacity_weight_multiplier=1.0

# Transfer
volume_transfer_salt_length=8
volume_transfer_key_length=16

# Volume
snapshot_same_host={{snapshot_same_host}}
cloned_volume_same_az={{cloned_volume_same_az}}
num_shell_tries=3
reserved_percentage=0
iscsi_num_targets=100
iscsi_target_prefix=iqn.2010-10.org.openstack:
iscsi_ip_address={{iscsi_ip_address}}
iscsi_port={{iscsi_port}}
num_volume_device_scan_tries=3
num_iser_scan_tries=3
volume_backend_name={{volume_backend_name}}
use_multipath_for_image_xfer=false
volume_clear=zero
volume_clear_size=0
iscsi_helper=tgtadm
volume_driver={{volume_driver}}
migration_create_volume_timeout_secs=300
volume_service_inithost_offload=false
volume_dd_blocksize=1M
volume_group = {{volume_group}}

# Exception
fatal_exception_format_errors=false

